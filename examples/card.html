<style>
body {
	font-family: -apple-system, BlinkMacSystemFont, sans-serif;
}
article {
	display: grid;
	position: relative;
	overflow: hidden;
	
	color: #fff;
	margin: 5px;
	padding: 1rem;
}
img {
	position: absolute;
	z-index: -1;
}
marquee {
	display: inline-block;
	max-width: 300px;
}
</style>

<body>


<script src="../src/indomitable.js"></script>
<script>

// https://codepen.io/darrylyeo/pen/bmgvGz?editors=0011

const $view = h`
	<h2>Project: @title! @random</h2>
	<main @main>
		<article>
			<img src:@imgsrc>
			<span>Comments: @comments</span>
			<div @div></div>
			<a href:@url target:@>View Project</a>
			@input
			<pre>@x + @y = ${() => x + y}</pre>
			${() => 1 + 2}
		</article>
	</main>
`
document.body.appendChild($view)

const refs = $view.refs
console.log(refs)

// const {title, comments, url} = refs
// title.nodeValue = 'Busy Buzzy Bee!'
// comments.nodeValue = 123

const state = $view.state
state.title = 'Busy Buzzy Bee'
state({
	x: 1,
	y: 2,
	comments: 100,
	url: 'https://darryl-yeo.com',
	imgsrc: 'https://picsum.photos/600/400'
})

// setInterval(() => state.x++, 1000)

const whee = h`<marquee>Bloink</marquee>`
setInterval(() => {
	state.random = [
		undefined,
		'',
		'Whee',
		h`Yay`,
		whee,
		[h`One`, h`<s>two</s>`, h`<b>three</b>`]
	][Math.random() * 5 | 0]
}, 500)

/*{
	const itemView = h`
	  <tr>
		  <td class="col-md-1">@id</td>
		  <td class="col-md-4">
			  <a @select>@label</a>
		  </td>
		  <td class="col-md-1"><a @del><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>x</a></td>
		  <td class="col-md-6"></td>
	  </tr>
	`
	function Item(item, scope) {
	  const root = itemView
	  const {id, label, select, del} = itemView.collect(root)

	  // One time data binding
	  id.nodeValue = item.id
	  label.nodeValue = item.label
	  select.onclick = () => scope.select(item)
	  del.onclick = () => scope.del(item)

	  // Handcrafted update function, we know exactly what parts of component will change after creation
	  // and what parameters we need to update the view
	  let a = '', a2,
		  b = item.label, b2
	  root.update = function(selected) {
		a2 = item.id === selected ? 'danger' : ''
		b2 = item.label

		if (a2 !== a) a = root.className = a2
		if (b2 !== b) b = label.nodeValue = b2
	  }

	  return root
	}

	// Create component
	const node = Item({id: 1, label: 'Wow'}, {
		select: item => console.debug({item}),
		del: item => console.debug({item})
	})
	document.body.appendChild(node)

	// And update the node
	const selected = 1
	node.update(selected)
}*/

</script>

</body>